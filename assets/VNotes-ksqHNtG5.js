import{h as q,d as h,o as i,c as g,a as o,t as _,e as r,w as $,b as N,A as b,f as M,n as T,r as f,v,u as B,g as E,i as p,j as S,k as U,l as G,m as H,p as F,F as X,q as j}from"./index-B1R7sW76.js";class z{constructor(e){this.http=e}async create(e,s){return this.http.post("/api/notes",{title:e,content:s})}async get(){return this.http.get("/api/notes")}async remove(e){return this.http.delete("/api/notes/"+e,null)}}const V=new z(q),D={class:"note"},O={class:"note__bottom"},J=h({__name:"CNote",props:{note:{}},emits:["updateNotes"],setup(t,{emit:e}){const s=e;async function l(a){try{await V.remove(a),s("updateNotes")}catch(n){console.log(n)}}return(a,n)=>(i(),g("div",D,[o("h4",null,_(a.note.title),1),o("p",null,_(a.note.content),1),o("div",O,[r(b,{onClick:n[0]||(n[0]=()=>l(a.note.id)),class:"note__button-closer"},{default:$(()=>n[1]||(n[1]=[o("span",{class:"note__cross-icon"},null,-1),N(" Удалить ")])),_:1})])]))}}),K={class:"input-counter"},k=h({__name:"InputCounter",props:{data:{}},setup(t){return(e,s)=>(i(),g("div",K,[o("div",null,[o("p",null,_(e.data.currentLength)+" / "+_(e.data.max),1)])]))}}),P=["value","placeholder","maxlength"],Q=h({__name:"InputText",props:["modelValue","errors","data"],emits:["update:modelValue"],setup(t){const e=t;return(s,l)=>(i(),g("div",{class:T(["app-input",{"error-visible":e.errors.length>0}])},[o("label",null,_(t.data.label),1),o("input",{type:"text",value:t.modelValue,placeholder:t.data.placeholder,maxlength:t.data.max,onInput:l[0]||(l[0]=a=>s.$emit("update:modelValue",a.target.value))},null,40,P),r(M,{errorsMessages:e.errors},null,8,["errorsMessages"]),r(k,{data:{currentLength:t.modelValue.length,max:t.data.max}},null,8,["data"])],2))}}),R=["value","placeholder","maxlength"],W=h({__name:"AppTextarea",props:["modelValue","errors","data"],emits:["update:modelValue"],setup(t){const e=t;return(s,l)=>(i(),g("div",{class:T(["app-input",{"error-visible":e.errors.length>0}])},[o("label",null,_(t.data.label),1),o("textarea",{value:t.modelValue,onInput:l[0]||(l[0]=a=>s.$emit("update:modelValue",a.target.value)),rows:"7",placeholder:t.data.placeholder,maxlength:t.data.max},null,40,R),r(M,{errorsMessages:e.errors},null,8,["errorsMessages"]),r(k,{data:{currentLength:t.modelValue.length,max:t.data.max}},null,8,["data"])],2))}}),Y={class:"note-editor__wrapper"},y=100,w=255,C=1,Z=h({__name:"CNoteEditor",emits:["updateNotes"],setup(t,{emit:e}){const s=e,{getErrorMsg:l}=H(),a=f(""),n=f(""),m=f([]),c={title:{required:v.required,minLength:v.minLength(C),maxLength:v.maxLength(y)},content:{required:v.required,minLength:v.minLength(C),maxLength:v.maxLength(w)}},u=B(c,{title:a,content:n});async function I(){if(!u.value.$invalid)try{await V.create(a.value,n.value),await V.get(),s("updateNotes")}catch(L){m.value=l(L)}}function A(){a.value="",n.value="",u.value.$reset()}return(L,d)=>(i(),E(G,{class:"note-editor",onClosed:A},{title:$(()=>d[2]||(d[2]=[N("Добавление заметки")])),form:$(()=>[o("form",{onSubmit:S(I,["prevent"])},[r(Q,{modelValue:p(u).title.$model,"onUpdate:modelValue":d[0]||(d[0]=x=>p(u).title.$model=x),errors:p(u).title.$errors,data:{label:"Название заметки",max:y,placeholder:"Введите название"}},null,8,["modelValue","errors","data"]),r(W,{modelValue:p(u).content.$model,"onUpdate:modelValue":d[1]||(d[1]=x=>p(u).content.$model=x),errors:p(u).content.$errors,data:{label:"Текст заметки",max:w,placeholder:"Введите текст"}},null,8,["modelValue","errors","data"]),o("div",Y,[r(b,{disabled:p(u).$invalid,class:"accent-button",type:"submit"},{default:$(()=>d[3]||(d[3]=[N("Добавить")])),_:1},8,["disabled"])])],32),r(U,{"errors-messages":m.value},null,8,["errors-messages"])]),_:1}))}}),ee={class:"notes"},te={class:"notes__grid"},ne=h({__name:"VNotes",setup(t){const e=f(!1),s=f([]);F(l);async function l(){try{const n=await V.get();s.value=n.data}catch(n){console.log(n)}}async function a(){await l(),e.value=!1}return(n,m)=>(i(),g("div",ee,[o("div",te,[(i(!0),g(X,null,j(s.value,c=>(i(),E(J,{key:c.id,note:c,onUpdateNotes:a},null,8,["note"]))),128))]),r(b,{onClick:m[0]||(m[0]=c=>e.value=!0),class:"notes__opener-btn accent-button"}),r(Z,{modelValue:e.value,"onUpdate:modelValue":m[1]||(m[1]=c=>e.value=c),onUpdateNotes:a},null,8,["modelValue"])]))}});export{ne as default};
