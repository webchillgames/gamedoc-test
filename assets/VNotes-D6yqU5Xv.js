import{h as U,d as h,o as i,c as g,a as o,t as _,e as r,w as $,b as N,A as b,f as C,n as E,r as f,v,u as q,g as B,i as k,j as p,k as S,l as F,m as G,p as H,q as X,F as j,s as z}from"./index-B2bQ6_Ol.js";class D{constructor(e){this.http=e}async create(e,s){return this.http.post("/api/notes",{title:e,content:s})}async get(){return this.http.get("/api/notes")}async remove(e){return this.http.delete("/api/notes/"+e,null)}}const V=new D(U),O={class:"note"},J={class:"note__bottom"},K=h({__name:"CNote",props:{note:{}},emits:["updateNotes"],setup(t,{emit:e}){const s=e;async function l(a){try{await V.remove(a),s("updateNotes")}catch(n){console.log(n)}}return(a,n)=>(i(),g("div",O,[o("h4",null,_(a.note.title),1),o("p",null,_(a.note.content),1),o("div",J,[r(b,{onClick:n[0]||(n[0]=()=>l(a.note.id)),class:"note__button-closer"},{default:$(()=>n[1]||(n[1]=[o("span",{class:"note__cross-icon"},null,-1),N(" Удалить ")])),_:1})])]))}}),P={class:"input-counter"},I=h({__name:"InputCounter",props:{data:{}},setup(t){return(e,s)=>(i(),g("div",P,[o("div",null,[o("p",null,_(e.data.currentLength)+" / "+_(e.data.max),1)])]))}}),Q=["value","placeholder","maxlength"],R=h({__name:"InputText",props:["modelValue","errors","data"],emits:["update:modelValue"],setup(t){const e=t;return(s,l)=>(i(),g("div",{class:E(["app-input",{"error-visible":e.errors.length>0}])},[o("label",null,_(t.data.label),1),o("input",{type:"text",value:t.modelValue,placeholder:t.data.placeholder,maxlength:t.data.max,onInput:l[0]||(l[0]=a=>s.$emit("update:modelValue",a.target.value))},null,40,Q),r(C,{errorsMessages:e.errors},null,8,["errorsMessages"]),r(I,{data:{currentLength:t.modelValue.length,max:t.data.max}},null,8,["data"])],2))}}),W=["value","placeholder","maxlength"],Y=h({__name:"AppTextarea",props:["modelValue","errors","data"],emits:["update:modelValue"],setup(t){const e=t;return(s,l)=>(i(),g("div",{class:E(["app-input",{"error-visible":e.errors.length>0}])},[o("label",null,_(t.data.label),1),o("textarea",{value:t.modelValue,onInput:l[0]||(l[0]=a=>s.$emit("update:modelValue",a.target.value)),rows:"7",placeholder:t.data.placeholder,maxlength:t.data.max},null,40,W),r(C,{errorsMessages:e.errors},null,8,["errorsMessages"]),r(I,{data:{currentLength:t.modelValue.length,max:t.data.max}},null,8,["data"])],2))}}),Z={class:"note-editor__wrapper"},w=100,M=255,T=1,ee=h({__name:"CNoteEditor",emits:["updateNotes"],setup(t,{emit:e}){const s=e,{getErrorMsg:l}=H(),a=f(""),n=f(""),m=f([]),c={title:{required:v.required,minLength:v.minLength(T),maxLength:v.maxLength(w)},content:{required:v.required,minLength:v.minLength(T),maxLength:v.maxLength(M)}},u=q(c,{title:a,content:n});B(L);async function A(){if(!u.value.$invalid)try{await V.create(a.value,n.value),await V.get(),s("updateNotes"),L()}catch(y){m.value=l(y)}}function L(){a.value="",n.value=""}return(y,d)=>(i(),k(G,{class:"note-editor"},{title:$(()=>d[2]||(d[2]=[N("Добавление заметки")])),form:$(()=>[o("form",{onSubmit:S(A,["prevent"])},[r(R,{modelValue:p(u).title.$model,"onUpdate:modelValue":d[0]||(d[0]=x=>p(u).title.$model=x),errors:p(u).title.$errors,data:{label:"Название заметки",max:w,placeholder:"Введите название"}},null,8,["modelValue","errors","data"]),r(Y,{modelValue:p(u).content.$model,"onUpdate:modelValue":d[1]||(d[1]=x=>p(u).content.$model=x),errors:p(u).content.$errors,data:{label:"Текст заметки",max:M,placeholder:"Введите текст"}},null,8,["modelValue","errors","data"]),o("div",Z,[r(b,{disabled:p(u).$invalid,class:"accent-button",type:"submit"},{default:$(()=>d[3]||(d[3]=[N("Добавить")])),_:1},8,["disabled"])])],32),r(F,{"errors-messages":m.value},null,8,["errors-messages"])]),_:1}))}}),te={class:"notes"},ae={class:"notes__grid"},se=h({__name:"VNotes",setup(t){const e=f(!1),s=f([]);X(l);async function l(){try{const n=await V.get();s.value=n.data}catch(n){console.log(n)}}async function a(){await l(),e.value=!1}return(n,m)=>(i(),g("div",te,[o("div",ae,[(i(!0),g(j,null,z(s.value,c=>(i(),k(K,{key:c.id,note:c,onUpdateNotes:a},null,8,["note"]))),128))]),r(b,{onClick:m[0]||(m[0]=c=>e.value=!0),class:"notes__opener-btn accent-button"}),r(ee,{modelValue:e.value,"onUpdate:modelValue":m[1]||(m[1]=c=>e.value=c),onUpdateNotes:a},null,8,["modelValue"])]))}});export{se as default};
